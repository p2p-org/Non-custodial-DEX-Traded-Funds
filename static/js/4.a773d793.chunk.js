(this["webpackJsonpsolana-defi-hackathon"]=this["webpackJsonpsolana-defi-hackathon"]||[]).push([[4],{377:function(e,t,n){},378:function(e,t,n){},379:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(5),c=n.n(a),o=n(375),r=Object(o.a)("div")({name:"Wrapper",class:"wrdya2m"}),u=Object(o.a)("div")({name:"Header",class:"h1vh307k"}),l=Object(o.a)("div")({name:"Title",class:"t1qfjroh"}),i=Object(o.a)("div")({name:"Description",class:"d8b2mdb"}),s=Object(o.a)("div")({name:"CloseWrapper",class:"c135gzia"}),m=Object(o.a)("div")({name:"Content",class:"c1whuod3"}),d=function(e){var t=e.title,n=e.description,a=e.close,o=e.children,d=e.className;return c.a.createElement(r,{className:d},c.a.createElement(u,null,t?c.a.createElement(l,null,t):void 0,n?c.a.createElement(i,null,n):void 0,a?c.a.createElement(s,{onClick:a}):void 0),o?c.a.createElement(m,null,o):void 0)};n(377)},380:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),c=n(5),o=n.n(c),r=n(375),u=n(34),l=n.n(u),i=Object(r.a)("div")({name:"Somefix",class:"shyxx1z"}),s=Object(r.a)("label")({name:"WrapperLabel",class:"w1q3m7th"}),m=Object(r.a)("input")({name:"InputElement",class:"i199phs3"}),d=function(e){var t=e.prefix,n=e.postfix,r=e.placeholder,u=e.value,d=e.onChange,p=e.style,b=e.className,f=Object(c.useState)(!1),v=Object(a.a)(f,2),k=v[0],h=v[1];return o.a.createElement(s,{style:p,className:l()(b,{isFocus:k})},o.a.createElement(i,{className:l()({left:!0})},t),o.a.createElement(m,{placeholder:r,value:u,onChange:d,onFocus:function(){h(!0)},onBlur:function(){h(!1)}}),o.a.createElement(i,{className:l()({right:!0})},n))};n(378)},386:function(e,t){},387:function(e,t,n){},393:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return fe}));var a=n(5),c=n.n(a),o=n(375),r=n(35),u=n(376),l=n.n(u),i=n(379),s=n(96),m=n(97),d=n(380),p=n(57),b=n(191),f=n(0),v=n.n(f),k=n(4),h=n(10),j=n(395),O=n(390),A=n(392),w=n(20),E=n(67),g=n(19),x=n(12),y=n(14),B=n(381),S=n(24),I=n(47),F=n(148),W=n.n(F),P=n(68),N=n(36),q=n(38),C=n(101),D=function(){var e=Object(k.a)(v.a.mark((function e(t,n,a,c,o){var r,u,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(q.c)(),u=new S.a,e.next=4,r.getMinimumBalanceForRentExemption(B.a.span);case 4:return l=e.sent,a.push(S.d.createAccount({fromPubkey:Object(P.d)().pubkey,newAccountPubkey:u.publicKey,lamports:l,space:B.a.span,programId:N.d})),a.push(B.b.createInitAccountInstruction(N.d,n,u.publicKey,t)),o.push(u),e.abrupt("return",u.publicKey);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,c,o){return e.apply(this,arguments)}}(),T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=n/100,c=1+("up"===t?a:-a);return e*c},z=function(e,t){return e.mintA.equals(t)},M=function(){function e(){Object(x.a)(this,e)}return Object(y.a)(e,null,[{key:"execute",value:function(){var e=Object(k.a)(v.a.mark((function e(t,n,a,c){var o,r,l,i,s,m,d,p,b,f,h,j,O,A,w,E,x,y,F,q,M,K=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=K.length>4&&void 0!==K[4]?K[4]:.1,r=[],l=[],i=[],s=a.account.data,m=s.poolTokenMint,d=s.poolTokenMintPopulated,p=s.assets,b=s.fundState,f=s.lqdFeeVault,h=s.initializerFeeVault,d){e.next=7;break}throw new Error("While Fund execute did not found pool token mint info for fund: ".concat(a.pubkey.toBase58()));case 7:if(b){e.next=9;break}throw new Error("While Fund execute fundState does not exists");case 9:return j=p.map((function(e){return e.vaultAddress})),e.next=12,S.c.findProgramAddress([a.pubkey.toBuffer()],N.a);case 12:return O=e.sent,A=Object(g.a)(O,1),w=A[0],e.next=17,D(Object(P.d)().pubkey,m,r,l,i);case 17:return E=e.sent,x=new S.a,i.push(x),y=new u.Decimal(0),F=p.map(function(){var e=Object(k.a)(v.a.mark((function e(a,s){var p,f,k,h,j,O,A,w,E,F,W,q,C,M,K,L,$,J,R,U,V,H,Y;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.vaultPopulated){e.next=2;break}throw new Error("While Fund execute did not found vaultPopulated for asset: ".concat(a.vaultAddress.toBase58()));case 2:if(p=c.find((function(e){return e.mintA.equals(a.mint)||e.mintB.equals(a.mint)}))){e.next=5;break}throw new Error("While Fund execute did not found pool for asset: ".concat(a.vaultAddress.toBase58()));case 5:if(p.tokenAccountAPopulated&&p.tokenAccountBPopulated){e.next=7;break}throw new Error("While Fund execute did not found tokenAccountAPopulated/tokenAccountBPopulated");case 7:return f=b.assetWeights[s]/10,k=n.div(f),console.log("fromAmount:",k.toString()),h=z(p,a.mint),j=p.tradeFeeNumerator.toNumber()/p.tradeFeeDenominator.toNumber(),O=h?[new u.Decimal(p.tokenAccountBPopulated.tokenAmount.amount),new u.Decimal(p.tokenAccountAPopulated.tokenAmount.amount)]:[new u.Decimal(p.tokenAccountAPopulated.tokenAmount.amount),new u.Decimal(p.tokenAccountBPopulated.tokenAmount.amount)],A=Object(g.a)(O,2),w=A[0],E=A[1],F=k,W=w.mul(E),q=w.add(F),C=W.divToInt(q),M=E.sub(C),K=M.mul(j).floor(),L=M.sub(K).toNumber(),$=T(L,"down",o),J=h?p.tokenAccountB:p.tokenAccountA,R=h?p.tokenAccountB:p.tokenAccountA,e.next=25,D(Object(P.d)().pubkey,m,r,l,i);case 25:return U=e.sent,r.push(B.b.createApproveInstruction(N.d,t,x.publicKey,Object(P.d)().pubkey,[],new B.c(k.toNumber()))),r.push(I.b.swapInstruction(p.address,new S.c(d.mintAuthority),x.publicKey,t,J,R,U,m,p.feeAccount,null,N.c,N.d,new I.a(k.toNumber()),$)),console.log("minimumToAmountWithSlippage:",$),V=Number(d.supply),H=a.vaultPopulated.tokenAmount.amount,Y=new u.Decimal(V*($-1)+1).div(H),y=y.add(Y),e.abrupt("return",x.publicKey);case 34:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=24,Promise.all(F);case 24:return q=e.sent,y=y.floor(),console.log("amount:",y.toString()),r.push(C.Fund.createExecuteInstruction(N.a,a.pubkey,m,j,w,E,q,Object(P.d)().pubkey,f,h,N.b,N.d,new W.a(y.toString()))),e.next=30,Object(P.e)([].concat(r,l),i);case 30:return M=e.sent,e.abrupt("return",Object(P.f)(M));case 32:case"end":return e.stop()}}),e)})));return function(t,n,a,c){return e.apply(this,arguments)}}()}]),e}(),K=n(66),L=n(69),$=n(54),J="/src/components/modals/Invest/model.ts",R=Object(r.a)(),U=w.b.createStore(new l.a(0),{loc:{file:J,line:20,column:23},name:"$amount",sid:"3qwl9z"}),V=w.b.createStore(null,{loc:{file:J,line:22,column:28},name:"$currentFund",sid:"u2al3i"}),H=w.b.createEvent({loc:{file:J,line:24,column:29},name:"investClicked",sid:"-wqta1p"}),Y=w.b.createEvent({loc:{file:J,line:26,column:25},name:"setAmount",sid:"7dn3pp"}),G=w.b.createEvent({loc:{file:J,line:27,column:28},name:"changeAmount",sid:"xv4r4n"}),Q=Object(h.combine)({"\u0254":[K.a,V,function(e,t){var n;if(!t)return null;var a=null===(n=t.account.data.fundState)||void 0===n?void 0:n.basicAsset.mint.toBase58();if(!a)return null;var c=e.filter((function(e){return e.account.data.mint===a}));return 0===c.length?null:c[0]}],config:{loc:{file:J,line:29,column:33},name:"$baseTokenAccount",sid:"-krmmzo"}}),X=Object(h.combine)({"\u0254":[K.b.pending,L.b.pending,$.c.pending,$.b.pending,E.b.pending,function(e,t,n,a,c){return e||t||n||a||c}],config:{loc:{file:J,line:55,column:26},name:"$isLoading",sid:"-pzty7w"}});U.on(Y,(function(e,t){return t})).on(G,(function(e,t){return new l.a(Number(t.currentTarget.value))}));var Z=function(e){return function(t){return Object(j.a)(Object(O.a)(Object(A.a)(["mint"],t.mintA),Object(A.a)(["mint"],t.mintB)),e)}};H.watch(Object(k.a)(v.a.mark((function e(){var t,n,a,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=V.getState()){e.next=4;break}return console.error("fund did not passed"),e.abrupt("return");case 4:if(n=Q.getState()){e.next=8;break}return console.error("baseTokenAccount did not passed"),e.abrupt("return");case 8:if((a=E.a.getState().filter(Z(t.account.data.assets))).length===t.account.data.assets.length){e.next=12;break}return console.error("did not enought pools for assets"),e.abrupt("return");case 12:c=U.getState().mul(Math.pow(10,n.account.data.tokenAmount.decimals)),M.execute(n.pubkey,c,t,a);case 14:case"end":return e.stop()}}),e)})))),Object(h.forward)({"\u0254":{from:R.open,to:V},config:{loc:{file:J,line:99,column:0},sid:"np9zcg"}});var _=Object(o.a)(i.a)({name:"WrapperModal",class:"wfmvxsj"}),ee=Object(o.a)("div")({name:"Wrapper",class:"w1ighdka"}),te=Object(o.a)("div")({name:"InvestWrapper",class:"i1ld7rsh"}),ne=Object(o.a)("div")({name:"FundInfoWrapper",class:"f1iv7vuw"}),ae=Object(o.a)("div")({name:"FundName",class:"ffut69q"}),ce=Object(o.a)("div")({name:"InputsWrapper",class:"i40hec8"}),oe=Object(o.a)("div")({name:"BalanceWrapper",class:"boqkvbh"}),re=Object(o.a)("div")({name:"OptionsWrapper",class:"osd9qmk"}),ue=Object(o.a)("div")({name:"AvailableBalance",class:"aqzjtjv"}),le=Object(o.a)("div")({name:"Option",class:"o1wxrzfk"}),ie=Object(o.a)("div")({name:"TransactionInfoWrapper",class:"tffe7vu"}),se=Object(o.a)("div")({name:"InfoLine",class:"iclqlbv"}),me=Object(o.a)("div")({name:"InfoLeft",class:"i12a81ot"}),de=Object(o.a)("div")({name:"InfoRight",class:"i1v39r4q"}),pe=Object(o.a)("div")({name:"Footer",class:"f1h25kmo"}),be=Object(o.a)(s.a)({name:"InvestButton",class:"i8g09c3"}),fe=function(e){var t=e.fund,n=e.close;Object(r.b)(R,t);var o=Object(r.c)(Q),l=Object(r.c)(U),i=Object(r.c)(X),s=Object(a.useMemo)((function(){return b.a.devnet.find((function(e){return e.address===t.pubkey.toBase58()}))}),[t]),f=function(){o&&Y(new u.Decimal(o.account.data.tokenAmount.uiAmount))};return c.a.createElement(_,{title:"Invest",close:n},c.a.createElement(ee,null,c.a.createElement(te,null,c.a.createElement(ne,null,c.a.createElement(m.a,{size:64,src:null===s||void 0===s?void 0:s.icon}),c.a.createElement(ae,null,s?"".concat(s.fundName," (").concat(s.fundSymbol,")"):t.account.data.name)),c.a.createElement(ce,null,c.a.createElement(d.a,{prefix:"Buy",postfix:s?s.fundSymbol:Object(p.b)(t.account.data.poolTokenMint.toBase58()),placeholder:"0.0"}),c.a.createElement(d.a,{prefix:"Pay",postfix:"USDC",placeholder:"0.0",value:l.toString(),onChange:G})),o?c.a.createElement(oe,null,c.a.createElement(re,null,c.a.createElement(le,{onClick:f},"Max: ",o.account.data.tokenAmount.uiAmount),c.a.createElement(le,{onClick:function(){return Y(new u.Decimal(o.account.data.tokenAmount.uiAmount/2))}},"1/2"),c.a.createElement(le,{onClick:function(){return Y(new u.Decimal(o.account.data.tokenAmount.uiAmount/4))}},"1/4")),c.a.createElement(ue,{onClick:f},"Balance: ",o.account.data.tokenAmount.uiAmount," ","USDC")):null),c.a.createElement(ie,null,c.a.createElement(se,null,c.a.createElement(me,null,"You\u2019ll receive:"),c.a.createElement(de,null,"21.1507"," ",s?s.fundSymbol:Object(p.b)(t.account.data.poolTokenMint.toBase58()))),c.a.createElement(se,null,c.a.createElement(me,null,"Transaction Fee:"),c.a.createElement(de,null,"0.00012 SOL"))),c.a.createElement(pe,null,c.a.createElement(be,{full:!0,primary:!0,onClick:H,disabled:i},i?"Loading...":"Invest now","gst"))))};n(387)}}]);
//# sourceMappingURL=4.a773d793.chunk.js.map