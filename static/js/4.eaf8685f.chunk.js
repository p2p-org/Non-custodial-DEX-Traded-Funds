(this["webpackJsonpsolana-defi-hackathon"]=this["webpackJsonpsolana-defi-hackathon"]||[]).push([[4],{379:function(e,t,n){},380:function(e,t,n){},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(19),c=n(5),o=n.n(c),r=n(376),u=n(34),l=n.n(u),i=Object(r.a)("div")({name:"Somefix",class:"si8wjea"}),s=Object(r.a)("label")({name:"WrapperLabel",class:"w1o5mjua"}),d=Object(r.a)("input")({name:"InputElement",class:"ihh2l9s"}),m=function(e){var t=e.prefix,n=e.postfix,r=e.placeholder,u=e.value,m=e.onChange,p=e.style,b=e.className,f=Object(c.useState)(!1),v=Object(a.a)(f,2),k=v[0],h=v[1];return o.a.createElement(s,{style:p,className:l()(b,{isFocus:k})},o.a.createElement(i,{className:l()({left:!0})},t),o.a.createElement(d,{placeholder:r,value:u,onChange:m,onFocus:function(){h(!0)},onBlur:function(){h(!1)}}),o.a.createElement(i,{className:l()({right:!0})},n))};n(380)},382:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(5),c=n.n(a),o=n(376),r=Object(o.a)("div")({name:"Wrapper",class:"w82ckn6"}),u=Object(o.a)("div")({name:"Header",class:"h1tvkl4y"}),l=Object(o.a)("div")({name:"Title",class:"t7cea0"}),i=Object(o.a)("div")({name:"Description",class:"djlpkkk"}),s=Object(o.a)("div")({name:"CloseWrapper",class:"c1qa3ib2"}),d=Object(o.a)("div")({name:"Content",class:"co6ih9x"}),m=function(e){var t=e.title,n=e.description,a=e.close,o=e.children,m=e.className;return c.a.createElement(r,{className:m},c.a.createElement(u,null,t?c.a.createElement(l,null,t):void 0,n?c.a.createElement(i,null,n):void 0,a?c.a.createElement(s,{onClick:a}):void 0),o?c.a.createElement(d,null,o):void 0)};n(379)},388:function(e,t){},389:function(e,t,n){},395:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return de}));var a=n(5),c=n.n(a),o=n(376),r=n(35),u=n(378),l=n.n(u),i=n(382),s=n(96),d=n(97),m=n(381),p=n(58),b=n(149),f=n(0),v=n.n(f),k=n(4),h=n(10),j=n(397),A=n(392),O=n(394),w=n(20),g=n(67),x=n(19),E=n(12),y=n(14),B=n(383),S=n(24),F=n(47),P=n(148),W=n.n(P),N=n(68),C=n(36),I=n(38),D=n(101),T=function(){var e=Object(k.a)(v.a.mark((function e(t,n,a,c,o){var r,u,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(I.c)(),u=new S.a,e.next=4,r.getMinimumBalanceForRentExemption(B.a.span);case 4:return l=e.sent,a.push(S.d.createAccount({fromPubkey:Object(N.d)().pubkey,newAccountPubkey:u.publicKey,lamports:l,space:B.a.span,programId:C.d})),a.push(B.b.createInitAccountInstruction(C.d,n,u.publicKey,t)),o.push(u),e.abrupt("return",u.publicKey);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,c,o){return e.apply(this,arguments)}}(),z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=n/100,c=1+("up"===t?a:-a);return e*c},q=function(e,t){return e.mintA.equals(t)},M=function(){function e(){Object(E.a)(this,e)}return Object(y.a)(e,null,[{key:"execute",value:function(){var e=Object(k.a)(v.a.mark((function e(t,n,a,c){var o,r,l,i,s,d,m,p,b,f,h,j,A,O,w,g,E,y,P,I,M,K=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=K.length>4&&void 0!==K[4]?K[4]:.1,r=[],l=[],i=[],s=a.account.data,d=s.poolTokenMint,m=s.poolTokenMintPopulated,p=s.assets,b=s.fundState,f=s.lqdFeeVault,h=s.initializerFeeVault,m){e.next=7;break}throw new Error("While Fund execute did not found pool token mint info for fund: ".concat(a.pubkey.toBase58()));case 7:if(b){e.next=9;break}throw new Error("While Fund execute fundState does not exists");case 9:return j=p.map((function(e){return e.vaultAddress})),e.next=12,S.c.findProgramAddress([a.pubkey.toBuffer()],C.a);case 12:return A=e.sent,O=Object(x.a)(A,1),w=O[0],e.next=17,T(Object(N.d)().pubkey,d,r,l,i);case 17:return g=e.sent,E=new S.a,i.push(E),y=new u.Decimal(0),P=p.map(function(){var e=Object(k.a)(v.a.mark((function e(a,s){var p,f,k,h,j,A,O,w,g,P,W,I,D,M,K,$,L,J,U,V,H,R,G;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.vaultPopulated){e.next=2;break}throw new Error("While Fund execute did not found vaultPopulated for asset: ".concat(a.vaultAddress.toBase58()));case 2:if(p=c.find((function(e){return e.mintA.equals(a.mint)||e.mintB.equals(a.mint)}))){e.next=5;break}throw new Error("While Fund execute did not found pool for asset: ".concat(a.vaultAddress.toBase58()));case 5:if(p.tokenAccountAPopulated&&p.tokenAccountBPopulated){e.next=7;break}throw new Error("While Fund execute did not found tokenAccountAPopulated/tokenAccountBPopulated");case 7:return f=b.assetWeights[s]/10,k=n.div(f),console.log("fromAmount:",k.toString()),h=q(p,a.mint),j=p.tradeFeeNumerator.toNumber()/p.tradeFeeDenominator.toNumber(),A=h?[new u.Decimal(p.tokenAccountBPopulated.tokenAmount.amount),new u.Decimal(p.tokenAccountAPopulated.tokenAmount.amount)]:[new u.Decimal(p.tokenAccountAPopulated.tokenAmount.amount),new u.Decimal(p.tokenAccountBPopulated.tokenAmount.amount)],O=Object(x.a)(A,2),w=O[0],g=O[1],P=k,W=w.mul(g),I=w.add(P),D=W.divToInt(I),M=g.sub(D),K=M.mul(j).floor(),$=M.sub(K).toNumber(),L=z($,"down",o),J=h?p.tokenAccountB:p.tokenAccountA,U=h?p.tokenAccountB:p.tokenAccountA,e.next=25,T(Object(N.d)().pubkey,d,r,l,i);case 25:return V=e.sent,r.push(B.b.createApproveInstruction(C.d,t,E.publicKey,Object(N.d)().pubkey,[],new B.c(k.toNumber()))),r.push(F.b.swapInstruction(p.address,new S.c(m.mintAuthority),E.publicKey,t,J,U,V,d,p.feeAccount,null,C.c,C.d,new F.a(k.toNumber()),L)),console.log("minimumToAmountWithSlippage:",L),H=Number(m.supply),R=a.vaultPopulated.tokenAmount.amount,G=new u.Decimal(H*(L-1)+1).div(R),y=y.add(G),e.abrupt("return",E.publicKey);case 34:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=24,Promise.all(P);case 24:return I=e.sent,y=y.floor(),console.log("amount:",y.toString()),r.push(D.Fund.createExecuteInstruction(C.a,a.pubkey,d,j,w,g,I,Object(N.d)().pubkey,f,h,C.b,C.d,new W.a(y.toString()))),e.next=30,Object(N.e)([].concat(r,l),i);case 30:return M=e.sent,e.abrupt("return",Object(N.f)(M));case 32:case"end":return e.stop()}}),e)})));return function(t,n,a,c){return e.apply(this,arguments)}}()}]),e}(),K=n(66),$=n(69),L=n(53),J="/src/components/modals/Invest/model.ts",U=Object(r.a)(),V=w.b.createStore(new l.a(0),{loc:{file:J,line:20,column:23},name:"$amount",sid:"3qwl9z"}),H=w.b.createStore(null,{loc:{file:J,line:22,column:28},name:"$currentFund",sid:"u2al3i"}),R=w.b.createEvent({loc:{file:J,line:24,column:29},name:"investClicked",sid:"-wqta1p"}),G=w.b.createEvent({loc:{file:J,line:26,column:25},name:"setAmount",sid:"7dn3pp"}),Q=w.b.createEvent({loc:{file:J,line:27,column:28},name:"changeAmount",sid:"xv4r4n"}),X=Object(h.combine)({"\u0254":[K.a,H,function(e,t){var n;if(!t)return null;var a=null===(n=t.account.data.fundState)||void 0===n?void 0:n.basicAsset.mint.toBase58();if(!a)return null;var c=e.filter((function(e){return e.account.data.mint===a}));return 0===c.length?null:c[0]}],config:{loc:{file:J,line:29,column:33},name:"$baseTokenAccount",sid:"-krmmzo"}}),Y=Object(h.combine)({"\u0254":[K.b.pending,$.b.pending,L.c.pending,L.b.pending,g.b.pending,function(e,t,n,a,c){return e||t||n||a||c}],config:{loc:{file:J,line:55,column:26},name:"$isLoading",sid:"-pzty7w"}});V.on(G,(function(e,t){return t})).on(Q,(function(e,t){return new l.a(Number(t.currentTarget.value))}));var Z=function(e){return function(t){return Object(j.a)(Object(A.a)(Object(O.a)(["mint"],t.mintA),Object(O.a)(["mint"],t.mintB)),e)}};R.watch(Object(k.a)(v.a.mark((function e(){var t,n,a,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=H.getState()){e.next=4;break}return console.error("fund did not passed"),e.abrupt("return");case 4:if(n=X.getState()){e.next=8;break}return console.error("baseTokenAccount did not passed"),e.abrupt("return");case 8:if((a=g.a.getState().filter(Z(t.account.data.assets))).length===t.account.data.assets.length){e.next=12;break}return console.error("did not enought pools for assets"),e.abrupt("return");case 12:c=V.getState().mul(Math.pow(10,n.account.data.tokenAmount.decimals)),M.execute(n.pubkey,c,t,a);case 14:case"end":return e.stop()}}),e)})))),Object(h.forward)({"\u0254":{from:U.open,to:H},config:{loc:{file:J,line:99,column:0},sid:"np9zcg"}});var _=Object(o.a)(i.a)({name:"WrapperModal",class:"w1f7tvks"}),ee=Object(o.a)("div")({name:"Wrapper",class:"w10e2wrw"}),te=Object(o.a)("div")({name:"InvestWrapper",class:"i1ad0zhp"}),ne=Object(o.a)("div")({name:"FundInfoWrapper",class:"f10s7k37"}),ae=Object(o.a)("div")({name:"FundName",class:"f44ujzy"}),ce=Object(o.a)("div")({name:"InputsWrapper",class:"i1ojiar1"}),oe=Object(o.a)("div")({name:"BalanceWrapper",class:"bhigdd3"}),re=Object(o.a)("div")({name:"OptionsWrapper",class:"o1d3cl2m"}),ue=Object(o.a)("div")({name:"AvailableBalance",class:"a1e3isu9"}),le=Object(o.a)("div")({name:"Option",class:"oijhz7w"}),ie=Object(o.a)("div")({name:"Footer",class:"f19k4cic"}),se=Object(o.a)(s.a)({name:"InvestButton",class:"iqdepap"}),de=function(e){var t=e.fund,n=e.close;Object(r.b)(U,t);var o=Object(r.c)(X),l=Object(r.c)(V),i=Object(r.c)(Y),s=Object(a.useMemo)((function(){return b.a.devnet.find((function(e){return e.address===t.pubkey.toBase58()}))}),[t]),f=function(){o&&G(new u.Decimal(o.account.data.tokenAmount.uiAmount))};return c.a.createElement(_,{title:"Invest",close:n},c.a.createElement(ee,null,c.a.createElement(te,null,c.a.createElement(ne,null,c.a.createElement(d.a,{size:64,src:null===s||void 0===s?void 0:s.icon}),c.a.createElement(ae,null,s?"".concat(s.fundName," (").concat(s.fundSymbol,")"):t.account.data.name)),c.a.createElement(ce,null,c.a.createElement(m.a,{prefix:"Buy",postfix:s?s.fundSymbol:Object(p.b)(t.account.data.poolTokenMint.toBase58()),placeholder:"0.0"}),c.a.createElement(m.a,{prefix:"Pay",postfix:"USDC",placeholder:"0.0",value:l.toString(),onChange:Q})),o?c.a.createElement(oe,null,c.a.createElement(re,null,c.a.createElement(le,{onClick:f},"Max: ",o.account.data.tokenAmount.uiAmount),c.a.createElement(le,{onClick:function(){return G(new u.Decimal(o.account.data.tokenAmount.uiAmount/2))}},"1/2"),c.a.createElement(le,{onClick:function(){return G(new u.Decimal(o.account.data.tokenAmount.uiAmount/4))}},"1/4")),c.a.createElement(ue,{onClick:f},"Balance: ",o.account.data.tokenAmount.uiAmount," ","USDC")):null),c.a.createElement(ie,null,c.a.createElement(se,{full:!0,primary:!0,onClick:R,disabled:!0},i?"Loading...":"Temporarily unavailable"))))};n(389)}}]);
//# sourceMappingURL=4.eaf8685f.chunk.js.map